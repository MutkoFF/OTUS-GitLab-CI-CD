## Подходы безопасности в разработке. Shift Left
### Ответы на вопросы

#### На каком этапе пайплайна проводятся проверки статистического анализа (SAST), а на каком этапе динамического анализа (DAST) и почему?

В CI/CD-пайплайне проверки SAST желательно выполнять как можно раньше (подход shift left) во время сборки или сразу после коммита кода, до этапа деплоя. Это связано с тем, что SAST анализирует исходный код без запуска приложения. Такой подход позволяет быстро находить уязвимости (например, небезопасные конструкции, ошибки обработки данных) и исправлять их до того, как приложение будет собрано и развернуто. Чем раньше найдена проблема, тем дешевле, проще её исправить и тем меньше людей нужно задействовать.

Проверки DAST выполняются на более поздних этапах — после развертывания приложения в тестовой или staging-среде, то есть во время этапа тестирования или pre-production. DAST анализирует уже запущенное приложение, имитируя действия пользователя или злоумышленника. Поэтому для него необходимо, чтобы приложение было развернуто и доступно.

#### Какие варианты проверок лучше выполнить до запуска сборки?

До запуска сборки (на этапе pre-commit или сразу после push) лучше выполнять быстрые и лёгкие проверки, которые дают быструю обратную связь разработчику:

**Линтинг (lint) —** проверка стиля и базовых ошибок в коде. Позволяет отловить синтаксические проблемы и нарушения стандартов до сборки.

**Форматирование кода —** авто-проверка соответствия форматтеру (например, чтобы не пропустить неправильно оформленный код).

**Базовый SAST —** статический анализ на уровне исходников (поиск потенциальных уязвимостей и грубых ошибок).

**Проверка зависимостей (SCA) —** поиск уязвимостей в используемых библиотеках по manifest-файлам (package.json, pom.xml и т.д.).

**Secret scanning** — поиск случайно закоммиченных токенов, ключей и паролей.

Главный принцип — до сборки запускать проверки, которые выполняются быстро и не требуют готового артефакта, чтобы не тратить ресурсы CI и как можно раньше останавливать пайплайн при ошибках.

#### Какие варианты атак направленных на пайплайны бывают и какие инструменты или подходы призваны бороться с ними?

Атаки на CI/CD-пайплайны обычно нацелены либо на внедрение вредоносного кода, либо на кражу секретов, либо на компрометацию инфраструктуры сборки.

## Основные варианты атак

### 1. Компрометация исходного кода
- Вредоносные коммиты, подмена pull request  
- Захват аккаунта разработчика  
**Цель:** внедрить backdoor ещё до сборки.

### 2. Атаки через зависимости (Supply Chain)
- Использование уязвимых или вредоносных библиотек  
- Dependency confusion  
Часто встречается в экосистемах npm, PyPI и других публичных registry.

### 3. Компрометация CI-сервера
- Уязвимости в CI-системе (например, Jenkins)  
- Небезопасные плагины  
**Результат:** изменение процесса сборки или доступ к секретам.

### 4. Кража секретов
- Утечка токенов, SSH-ключей, cloud-credentials из логов  
- Вредоносный код, читающий переменные окружения CI  

### 5. Подмена артефактов
- Изменение Docker-образов или бинарников в registry  
- Отсутствие проверки целостности  

### 6. Атаки на инфраструктуру раннеров
- Container escape  
- Использование shared-runner для доступа к чужим данным  

## Инструменты и подходы защиты

### 1. Контроль доступа и Zero Trust
- MFA для разработчиков  
- Принцип наименьших привилегий (RBAC)  
- Защита веток и обязательный code review  

### 2. SAST, DAST и SCA
- Статический и динамический анализ  
- Анализ зависимостей (Dependabot, Snyk и др.)  

### 3. Secret Management
- Использование vault-хранилищ  
- Masking переменных в CI  
- Secret scanning  

### 4. Подпись и проверка артефактов
- Подпись контейнеров и релизов  
- Проверка checksum  
- Использование SBOM (Software Bill of Materials)  

### 5. Изолированные и ephemeral-раннеры
- Запуск сборок в одноразовых контейнерах  
- Разделение сред (dev/stage/prod)  

### 6. Мониторинг и аудит
- Логи аудита  
- Alerting при подозрительных действиях  
- Регулярное обновление CI-системы и плагинов  

---

В целом, защита пайплайна строится по принципу **secure by design**: защита кода, зависимостей, инфраструктуры сборки и артефактов доставки на каждом этапе CI/CD.